<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zaptime Embedding Modes Test</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1050px;
      margin: 0 auto;
      padding: 40px 20px;
      background: #f5f5f5;
    }
    h1 {
      color: #333;
      margin-bottom: 40px;
    }
    h2 {
      color: #555;
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #ddd;
    }
    .test-section {
      background: white;
      padding: 24px;
      border-radius: 8px;
      margin-bottom: 24px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .test-section p {
      color: #666;
      margin-bottom: 16px;
    }
    button.test-btn {
      background: #15B79E;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      margin-right: 10px;
      margin-bottom: 10px;
    }
    button.test-btn:hover {
      background: #0e9382;
    }
    button.test-btn.secondary {
      background: #6b7280;
    }
    button.test-btn.secondary:hover {
      background: #4b5563;
    }
    a[data-zaptime-link] {
      color: #15B79E;
      text-decoration: underline;
      cursor: pointer;
    }
    #inline-container {
      border: 2px dashed #ddd;
      min-height: 700px;
      border-radius: 8px;
    }
    .code-block {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 16px;
      border-radius: 6px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 13px;
      overflow-x: auto;
      margin: 16px 0;
    }
    .log-output {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      padding: 12px;
      border-radius: 6px;
      font-family: monospace;
      font-size: 12px;
      min-height: 60px;
      max-height: 150px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <h1>Zaptime Embedding Modes Test</h1>

  <!-- Test 1: Inline Mode (existing) -->
  <div class="test-section">
    <h2>1. Inline Mode (Existing)</h2>
    <p>The calendar renders directly inside a container element.</p>
    <div id="inline-container" style="background-color: #1e1e1e;"></div>

  </div>

  <!-- Test 2: Floating Button Mode -->
  <div class="test-section">
    <h2>2. Floating Button Mode</h2>
    <p>A floating button appears at the bottom of the screen. Click it to open the calendar modal.</p>

    <h3>Bottom-Right (custom styling - PRO)</h3>
    <button class="test-btn" onclick="createFloatingRight()">Create Bottom-Right Button</button>
    <button class="test-btn secondary" onclick="destroyFloatingRight()">Destroy</button>

    <h3>Bottom-Left (custom styling - PRO)</h3>
    <button class="test-btn" onclick="createFloatingLeft()">Create Bottom-Left Button</button>
    <button class="test-btn secondary" onclick="destroyFloatingLeft()">Destroy</button>

    <h3>Programmatic Control</h3>
    <button class="test-btn" onclick="openFloatingRight()">Open Modal (Right)</button>
    <button class="test-btn" onclick="closeFloatingRight()">Close Modal (Right)</button>

    <h3>Event Log</h3>
    <div class="log-output" id="floating-log"></div>
  </div>

  <!-- Test 3: Inline Button Mode -->
  <div class="test-section">
    <h2>3. Inline Button Mode</h2>
    <p>A button rendered inside a specified container element. Click it to open the calendar modal.</p>

    <h3>Button Container</h3>
    <div id="inline-button-container" style="border: 2px dashed #ddd; padding: 20px; border-radius: 8px; margin-bottom: 16px;">
      <!-- Inline button will be inserted here -->
    </div>

    <h3>Controls</h3>
    <button class="test-btn" onclick="createInlineButtonDemo()">Create Inline Button</button>
    <button class="test-btn secondary" onclick="destroyInlineButtonDemo()">Destroy</button>

    <h3>Programmatic Control</h3>
    <button class="test-btn" onclick="openInlineButtonModal()">Open Modal</button>
    <button class="test-btn" onclick="closeInlineButtonModal()">Close Modal</button>

    <h3>Event Log</h3>
    <div class="log-output" id="inline-button-log"></div>
  </div>

  <!-- Test 3b: Multiple Inline Buttons with Single Selector -->
  <div class="test-section">
    <h2>3b. Multiple Inline Buttons (Single Selector)</h2>
    <p>Using a class selector to create multiple buttons with a single <code>Zaptime.inlineButton()</code> call. All buttons share the same modal.</p>

    <h3>Multiple Button Containers (same class)</h3>
    <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 16px;">
      <div class="booking-btn" style="border: 2px dashed #ddd; padding: 20px; border-radius: 8px; flex: 1; min-width: 200px; text-align: center;">
        <small style="color: #666;">Nav area</small>
      </div>
      <div class="booking-btn" style="border: 2px dashed #ddd; padding: 20px; border-radius: 8px; flex: 1; min-width: 200px; text-align: center;">
        <small style="color: #666;">Hero area</small>
      </div>
      <div class="booking-btn" style="border: 2px dashed #ddd; padding: 20px; border-radius: 8px; flex: 1; min-width: 200px; text-align: center;">
        <small style="color: #666;">Footer area</small>
      </div>
    </div>

    <h3>Controls</h3>
    <button class="test-btn" onclick="createMultipleInlineButtons()">Create Multiple Buttons</button>
    <button class="test-btn secondary" onclick="destroyMultipleInlineButtons()">Destroy All</button>

    <h3>Event Log</h3>
    <div class="log-output" id="multiple-inline-log"></div>
  </div>

  <!-- Test 4: Popup Mode (External Element Trigger) -->
  <div class="test-section">
    <h2>4. Popup Mode (External Element Trigger)</h2>
    <p>Any element with <code>data-zaptime-link</code> attribute will open the calendar when clicked.</p>

    <button class="test-btn" onclick="initPopup()">Initialize Popup Mode</button>
    <button class="test-btn secondary" onclick="destroyPopup()">Destroy</button>

    <h3>Test Elements</h3>
    <p>
      Click this <a href="#" data-zaptime-link>link to book a meeting</a> or
      <button data-zaptime-link class="test-btn">this button</button>
    </p>

    <h3>Dynamic Element Test</h3>
    <button class="test-btn" onclick="addDynamicElement()">Add Dynamic Link</button>
    <div id="dynamic-container"></div>

    <h3>Programmatic Control</h3>
    <button class="test-btn" onclick="openPopup()">Open Popup Programmatically</button>
    <button class="test-btn" onclick="closePopup()">Close Popup</button>

    <h3>Event Log</h3>
    <div class="log-output" id="popup-log"></div>
  </div>

  <!-- Scripts - Load from local dist for testing new features -->
  <script src="./dist/zaptime.js"></script>
  <script>
    // Config
    var demoConfig = { token: 'f33slNABua1UavaXHr98hrxRxoj4qDBP' };

    // Render inline calendar immediately
    Zaptime({
      type: 'single',
      config: demoConfig
    }).render('#inline-container');

    // Instance references
    var floatingRight = null;
    var floatingLeft = null;
    var inlineButtonInstance = null;
    var popup = null;

    // Logging helpers
    function log(containerId, message) {
      var container = document.getElementById(containerId);
      var time = new Date().toLocaleTimeString();
      container.innerHTML += '[' + time + '] ' + message + '\n';
      container.scrollTop = container.scrollHeight;
    }

    // Floating Button - Right
    function createFloatingRight() {
      if (floatingRight) {
        log('floating-log', 'Right button already exists');
        return;
      }
      floatingRight = Zaptime.floatingButton({
        type: 'single',
        config: demoConfig,
        position: 'bottom-right',
        buttonText: 'Domluvit si konzultaci',
        buttonColor: '#6366f1',
        buttonTextColor: '#ffffff',
        onOpen: function() { log('floating-log', 'Right modal opened'); },
        onClose: function() { log('floating-log', 'Right modal closed'); }
      });
      log('floating-log', 'Created floating button (right) - ID: ' + floatingRight.id);
    }

    function destroyFloatingRight() {
      if (floatingRight) {
        floatingRight.destroy();
        log('floating-log', 'Destroyed floating button (right)');
        floatingRight = null;
      }
    }

    function openFloatingRight() {
      if (floatingRight) {
        floatingRight.open();
      } else {
        log('floating-log', 'Create button first');
      }
    }

    function closeFloatingRight() {
      if (floatingRight) {
        floatingRight.close();
      }
    }

    // Floating Button - Left
    function createFloatingLeft() {
      if (floatingLeft) {
        log('floating-log', 'Left button already exists');
        return;
      }
      floatingLeft = Zaptime.floatingButton({
        type: 'single',
        config: demoConfig,
        position: 'bottom-left',
        buttonText: 'Domluvit si konzultaci',
        buttonColor: '#6366f1',
        buttonTextColor: '#ffffff',
        onOpen: function() { log('floating-log', 'Left modal opened'); },
        onClose: function() { log('floating-log', 'Left modal closed'); }
      });
      log('floating-log', 'Created floating button (left) - ID: ' + floatingLeft.id);
    }

    function destroyFloatingLeft() {
      if (floatingLeft) {
        floatingLeft.destroy();
        log('floating-log', 'Destroyed floating button (left)');
        floatingLeft = null;
      }
    }

    // Inline Button Mode
    function createInlineButtonDemo() {
      if (inlineButtonInstance) {
        log('inline-button-log', 'Inline button already exists');
        return;
      }
      inlineButtonInstance = Zaptime.inlineButton({
        selector: '#inline-button-container',
        type: 'single',
        config: demoConfig,
        buttonText: 'Domluvit si konzultaci',
        buttonColor: '#6366f1',
        buttonTextColor: '#ffffff',
        onOpen: function() { log('inline-button-log', 'Modal opened'); },
        onClose: function() { log('inline-button-log', 'Modal closed'); }
      });
      log('inline-button-log', 'Created inline button - ID: ' + inlineButtonInstance.id);
    }

    function destroyInlineButtonDemo() {
      if (inlineButtonInstance) {
        inlineButtonInstance.destroy();
        log('inline-button-log', 'Destroyed inline button');
        inlineButtonInstance = null;
      }
    }

    function openInlineButtonModal() {
      if (inlineButtonInstance) {
        inlineButtonInstance.open();
      } else {
        log('inline-button-log', 'Create inline button first');
      }
    }

    function closeInlineButtonModal() {
      if (inlineButtonInstance) {
        inlineButtonInstance.close();
      }
    }

    // Multiple Inline Buttons Mode
    var multipleInlineInstance = null;

    function createMultipleInlineButtons() {
      if (multipleInlineInstance) {
        log('multiple-inline-log', 'Multiple buttons already exist');
        return;
      }
      multipleInlineInstance = Zaptime.inlineButton({
        selector: '.booking-btn',
        type: 'single',
        config: demoConfig,
        buttonText: 'Book a Meeting',
        buttonColor: '#15B79E',
        buttonTextColor: '#ffffff',
        onOpen: function() { log('multiple-inline-log', 'Modal opened (shared by all buttons)'); },
        onClose: function() { log('multiple-inline-log', 'Modal closed'); }
      });
      log('multiple-inline-log', 'Created multiple inline buttons - ID: ' + multipleInlineInstance.id);
    }

    function destroyMultipleInlineButtons() {
      if (multipleInlineInstance) {
        multipleInlineInstance.destroy();
        log('multiple-inline-log', 'Destroyed all inline buttons');
        multipleInlineInstance = null;
      }
    }

    // Popup Mode
    function initPopup() {
      if (popup) {
        log('popup-log', 'Popup already initialized');
        return;
      }
      popup = Zaptime.popup({
        type: 'single',
        config: demoConfig,
        selector: '[data-zaptime-link]',
        onOpen: function() { log('popup-log', 'Popup opened'); },
        onClose: function() { log('popup-log', 'Popup closed'); }
      });
      log('popup-log', 'Popup initialized - ID: ' + popup.id);
    }

    function destroyPopup() {
      if (popup) {
        popup.destroy();
        log('popup-log', 'Popup destroyed');
        popup = null;
      }
    }

    function openPopup() {
      if (popup) {
        popup.open();
      } else {
        log('popup-log', 'Initialize popup first');
      }
    }

    function closePopup() {
      if (popup) {
        popup.close();
      }
    }

    var dynamicCounter = 0;
    function addDynamicElement() {
      dynamicCounter++;
      var container = document.getElementById('dynamic-container');
      var link = document.createElement('a');
      link.href = '#';
      link.setAttribute('data-zaptime-link', '');
      link.textContent = 'Dynamic Link #' + dynamicCounter;
      link.style.marginRight = '10px';
      link.style.color = '#15B79E';
      container.appendChild(link);
      log('popup-log', 'Added dynamic link #' + dynamicCounter + ' (should auto-bind if MutationObserver works)');
    }

    console.log('Zaptime test page loaded. Use the buttons above to test different embedding modes.');
  </script>
</body>
</html>
